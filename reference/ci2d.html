<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create 2-dimensional empirical confidence regions — ci2d • gplots</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Create 2-dimensional empirical confidence regions — ci2d"><meta property="og:description" content="Create 2-dimensional empirical confidence regions from provided data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gplots</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/venn.html">Venn Diagrams with `gplots`</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/talgalili/gplots/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create 2-dimensional empirical confidence regions</h1>
    <small class="dont-index">Source: <a href="https://github.com/talgalili/gplots/blob/master/R/ci2d.R" class="external-link"><code>R/ci2d.R</code></a></small>
    <div class="hidden name"><code>ci2d.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create 2-dimensional empirical confidence regions from provided data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ci2d</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nbins <span class="op">=</span> <span class="fl">51</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bkde2D"</span>, <span class="st">"hist2d"</span><span class="op">)</span>,</span>
<span>  <span class="va">bandwidth</span>,</span>
<span>  factor <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ci.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>  show <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"filled.contour"</span>, <span class="st">"contour"</span>, <span class="st">"image"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">topo.colors</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">breaks</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  show.points <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"pch"</span><span class="op">)</span>,</span>
<span>  points.col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  <span class="va">xlab</span>,</span>
<span>  <span class="va">ylab</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>either a vector containing the x coordinates or a matrix with 2
columns.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>a vector contianing the y coordinates, not required if `x' is
matrix</p></dd>


<dt id="arg-nbins">nbins<a class="anchor" aria-label="anchor" href="#arg-nbins"></a></dt>
<dd><p>number of bins in each dimension. May be a scalar or a 2
element vector.  Defaults to 51.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>One of "bkde2D" (for KernSmooth::bdke2d) or "hist2d" (for
gplots::hist2d) specifyting the name of the method to create the 2-d
density summarizing the data.  Defaults to "bkde2D".</p></dd>


<dt id="arg-bandwidth">bandwidth<a class="anchor" aria-label="anchor" href="#arg-bandwidth"></a></dt>
<dd><p>Bandwidth to use for <code><a href="https://rdrr.io/pkg/KernSmooth/man/bkde2D.html" class="external-link">KernSmooth::bkde2D</a></code>.  See below
for default value.</p></dd>


<dt id="arg-factor">factor<a class="anchor" aria-label="anchor" href="#arg-factor"></a></dt>
<dd><p>Numeric scaling factor for bandwidth.  Useful for exploring
effect of changing the bandwidth.  Defaults to 1.0.</p></dd>


<dt id="arg-ci-levels">ci.levels<a class="anchor" aria-label="anchor" href="#arg-ci-levels"></a></dt>
<dd><p>Confidence level(s) to use for plotting data. Defaults to
<code>c(0.5, 0.75, 0.9, 0.95, 0.975)</code></p></dd>


<dt id="arg-show">show<a class="anchor" aria-label="anchor" href="#arg-show"></a></dt>
<dd><p>Plot type to be displaed.  One of "filled.contour", "contour",
"image", or "none".  Defaults to "filled.contour".</p></dd>


<dt id="arg-col">col<a class="anchor" aria-label="anchor" href="#arg-col"></a></dt>
<dd><p>Colors to use for plots.</p></dd>


<dt id="arg-show-points">show.points<a class="anchor" aria-label="anchor" href="#arg-show-points"></a></dt>
<dd><p>Boolean indicating whether original data values should
be plotted.  Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-pch">pch<a class="anchor" aria-label="anchor" href="#arg-pch"></a></dt>
<dd><p>Point type for plots.  See <code>points</code> for details.</p></dd>


<dt id="arg-points-col">points.col<a class="anchor" aria-label="anchor" href="#arg-points-col"></a></dt>
<dd><p>Point color for plotting original data. Defaiults to
"red".</p></dd>


<dt id="arg-xlab-ylab">xlab, ylab<a class="anchor" aria-label="anchor" href="#arg-xlab-ylab"></a></dt>
<dd><p>Axis labels</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code><a href="https://rdrr.io/pkg/KernSmooth/man/bkde2D.html" class="external-link">KernSmooth::bkde2D</a></code> or
<code><a href="hist2d.html">gplots::hist2d</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>ci2d</code> object consisting of a list containing (at least) the
following elements:</p>
<dl><dt>nobs</dt>
<dd><p>number of original data points</p></dd>
 <dt>x</dt>
<dd><p>x
position of each density estimate bin</p></dd>
 <dt>y</dt>
<dd><p>y position of each density
estimate bin</p></dd>
 <dt>density</dt>
<dd><p>Matrix containing the probability density of
each bin (count in bin/total count)</p></dd>
 <dt>cumDensity</dt>
<dd><p>Matrix where each
element contains the cumulative probability density of all elements with
the same density (used to create the confidence region plots)</p></dd>

<dt>contours</dt>
<dd><p>List of contours of each confidence region.</p></dd>

<dt>call</dt>
<dd><p>Call used to create this object</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function utilizes either <code><a href="https://rdrr.io/pkg/KernSmooth/man/bkde2D.html" class="external-link">KernSmooth::bkde2D</a></code> or
<code><a href="hist2d.html">gplots::hist2d</a></code> to estmate a 2-dimensional density of the data passed
as an argument.  This density is then used to create and (optionally)
display confidence regions.</p>
<p>When <code>bandwidth</code> is ommited and <code>method="bkde2d"</code>,
<code><a href="https://rdrr.io/pkg/KernSmooth/man/dpik.html" class="external-link">KernSmooth::dpik</a></code> is appled in x and y dimensions to select the
bandwidth.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Confidence intervals generated by ci2d are <em>approximate</em>, and
are subject to biases and/or artifacts induced by the binning or kernel
smoothing method, bin locations, bin sizes, and kernel bandwidth.</p>
<p>The <code><a href="https://rdrr.io/pkg/r2d2/man/conf2d.html" class="external-link">conf2d</a></code> function in the <span class="pkg">r2d2</span> package may
create a more accurate confidence region, and reports the actual proportion
of points inside the region.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/KernSmooth/man/bkde2D.html" class="external-link">bkde2D</a></code>, <code><a href="https://rdrr.io/pkg/r2d2/man/conf2d.html" class="external-link">conf2d</a></code>,
<code><a href="https://rdrr.io/pkg/KernSmooth/man/dpik.html" class="external-link">dpik</a></code>, <code><a href="hist2d.html">hist2d</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Gregory R. Warnes <a href="mailto:greg@warnes.net">greg@warnes.net</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">####</span></span></span>
<span class="r-in"><span>   <span class="co">## Basic usage </span></span></span>
<span class="r-in"><span>   <span class="co">####</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">geyser</span>, package<span class="op">=</span><span class="st">"MASS"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">geyser</span><span class="op">$</span><span class="va">duration</span></span></span>
<span class="r-in"><span>   <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">geyser</span><span class="op">$</span><span class="va">waiting</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co"># 2-d confidence intervals based on binned kernel density estimate</span></span></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span>                   <span class="co"># filled contour plot</span></span></span>
<span class="r-plt img"><img src="ci2d-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, show.points<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co"># show original data</span></span></span>
<span class="r-plt img"><img src="ci2d-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co"># image plot</span></span></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, show<span class="op">=</span><span class="st">"image"</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, show<span class="op">=</span><span class="st">"image"</span>, show.points<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ci2d-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co"># contour plot</span></span></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, show<span class="op">=</span><span class="st">"contour"</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, show<span class="op">=</span><span class="st">"contour"</span>, col<span class="op">=</span><span class="st">"black"</span>, show.points<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ci2d-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">####</span></span></span>
<span class="r-in"><span>   <span class="co">## Control Axis scales</span></span></span>
<span class="r-in"><span>   <span class="co">####</span></span></span>
<span class="r-in"><span>   <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2000</span>, sd<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2000</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co"># 2-d confidence intervals based on binned kernel density estimate</span></span></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ci2d-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co"># 2-d confidence intervals based on 2d histogram</span></span></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, method<span class="op">=</span><span class="st">"hist2d"</span>, nbins<span class="op">=</span><span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ci2d-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>   <span class="co"># Require same scale for each axis, this looks oval</span></span></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, range.x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ci2d-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, method<span class="op">=</span><span class="st">"hist2d"</span>, same.scale<span class="op">=</span><span class="cn">TRUE</span>, nbins<span class="op">=</span><span class="fl">25</span><span class="op">)</span> <span class="co"># hist2d </span></span></span>
<span class="r-plt img"><img src="ci2d-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">####</span></span></span>
<span class="r-in"><span>   <span class="co">## Control smoothing and binning </span></span></span>
<span class="r-in"><span>   <span class="co">####</span></span></span>
<span class="r-in"><span>   <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2000</span>, sd<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2000</span>, mean<span class="op">=</span><span class="va">x</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co"># Default 2-d confidence intervals based on binned kernel density estimate</span></span></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ci2d-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co"># change the smoother bandwidth</span></span></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,</span></span>
<span class="r-in"><span>        bandwidth<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fl">8</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">/</span><span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span>       <span class="op">)</span></span></span>
<span class="r-plt img"><img src="ci2d-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co"># change the smoother number of bins</span></span></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, nbins<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Binning grid too coarse for current (small) bandwidth: consider increasing 'gridsize'</span>
<span class="r-plt img"><img src="ci2d-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ci2d-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, nbins<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ci2d-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co"># Default 2-d confidence intervals based on 2d histogram</span></span></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, method<span class="op">=</span><span class="st">"hist2d"</span>, show.points<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ci2d-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co"># change the number of histogram bins</span></span></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, nbin<span class="op">=</span><span class="fl">10</span>, method<span class="op">=</span><span class="st">"hist2d"</span>, show.points<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span></span>
<span class="r-plt img"><img src="ci2d-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, nbin<span class="op">=</span><span class="fl">25</span>, method<span class="op">=</span><span class="st">"hist2d"</span>, show.points<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span></span>
<span class="r-plt img"><img src="ci2d-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">####</span></span></span>
<span class="r-in"><span>   <span class="co">## Perform plotting manually</span></span></span>
<span class="r-in"><span>   <span class="co">####</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">geyser</span>, package<span class="op">=</span><span class="st">"MASS"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co"># let ci2d handle plotting contours...</span></span></span>
<span class="r-in"><span>   <span class="fu">ci2d</span><span class="op">(</span><span class="va">geyser</span><span class="op">$</span><span class="va">duration</span>, <span class="va">geyser</span><span class="op">$</span><span class="va">waiting</span>, show<span class="op">=</span><span class="st">"contour"</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ci2d-17.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co"># call contour() directly, show the 90 percent CI, and the mean point </span></span></span>
<span class="r-in"><span>   <span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">ci2d</span><span class="op">(</span><span class="va">geyser</span><span class="op">$</span><span class="va">duration</span>, <span class="va">geyser</span><span class="op">$</span><span class="va">waiting</span>, show<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span><span class="va">est</span><span class="op">$</span><span class="va">x</span>, <span class="va">est</span><span class="op">$</span><span class="va">y</span>, <span class="va">est</span><span class="op">$</span><span class="va">cumDensity</span>,</span></span>
<span class="r-in"><span>           xlab<span class="op">=</span><span class="st">"duration"</span>, ylab<span class="op">=</span><span class="st">"waiting"</span>,</span></span>
<span class="r-in"><span>           levels<span class="op">=</span><span class="fl">0.90</span>, lwd<span class="op">=</span><span class="fl">4</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">geyser</span><span class="op">$</span><span class="va">duration</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">geyser</span><span class="op">$</span><span class="va">waiting</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         col<span class="op">=</span><span class="st">"red"</span>, pch<span class="op">=</span><span class="st">"X"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ci2d-18.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">####</span></span></span>
<span class="r-in"><span>   <span class="co">## Extract confidence region values</span></span></span>
<span class="r-in"><span>   <span class="co">###</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">geyser</span>, package<span class="op">=</span><span class="st">"MASS"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">## Empirical 90 percent confidence limits</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span> <span class="va">geyser</span><span class="op">$</span><span class="va">duration</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       5%      95% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.781667 4.803333 </span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span> <span class="va">geyser</span><span class="op">$</span><span class="va">waiting</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5% 95% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  49  92 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">## Bivariate 90 percent confidence region</span></span></span>
<span class="r-in"><span>   <span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">ci2d</span><span class="op">(</span><span class="va">geyser</span><span class="op">$</span><span class="va">duration</span>, <span class="va">geyser</span><span class="op">$</span><span class="va">waiting</span>, show<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">est</span><span class="op">$</span><span class="va">contours</span><span class="op">)</span> <span class="co">## show available contours</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "0.5"   "0.5"   "0.5"   "0.75"  "0.75"  "0.9"   "0.9"   "0.9"   "0.95" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "0.975" "0.975" "0.975" "1"     "1"     "1"     "1"    </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="va">ci.90</span> <span class="op">&lt;-</span> <span class="va">est</span><span class="op">$</span><span class="va">contours</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">est</span><span class="op">$</span><span class="va">contours</span><span class="op">)</span><span class="op">==</span><span class="st">"0.9"</span><span class="op">]</span>  <span class="co"># get region(s)</span></span></span>
<span class="r-in"><span>   <span class="va">ci.90</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ci.90</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="cn">NA</span>, <span class="va">ci.90</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="cn">NA</span>, <span class="va">ci.90</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># join them</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ci.90</span><span class="op">)</span>                  <span class="co"># show full contour</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            x        y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1.526652 78.00100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1.520334 78.43451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1.505526 79.90177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   1.498197 81.36902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   1.490886 82.83628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   1.479440 84.30353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   1.462897 85.77079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   1.449958 87.23804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   1.440848 88.70530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  1.442839 90.17255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  1.454784 91.63981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  1.472003 93.10706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  1.500685 94.57432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  1.526652 95.19393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  1.559131 96.04157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  1.617806 97.50883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  1.627590 97.68333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  1.714635 98.97608</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  1.728529 99.16754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  1.829467 99.52422</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  1.902190 98.97608</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  1.930405 98.75198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  2.001441 97.50883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  2.031344 96.96819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  2.085418 96.04157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  2.132282 95.33502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  2.215860 94.57432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  2.233221 94.38900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  2.317325 93.10706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  2.334159 92.65774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  2.364668 91.63981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  2.379204 90.17255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33  2.383578 88.70530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  2.386307 87.23804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  2.388831 85.77079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  2.399318 84.30353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37  2.435098 82.94130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38  2.536036 83.00782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39  2.576349 82.83628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40  2.636974 82.27676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41  2.667152 81.36902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42  2.688972 79.90177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43  2.694766 78.43451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44  2.684505 76.96726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45  2.655260 75.50000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46  2.636974 75.15474</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47  2.569526 74.03274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48  2.536036 73.63059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49  2.435098 72.97800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50  2.405518 72.56549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51  2.334159 71.55041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52  2.313730 71.09823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53  2.251786 69.63098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54  2.233221 69.32254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55  2.142469 68.16372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56  2.132282 68.03823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57  2.031344 67.61998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58  1.930405 67.86785</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59  1.904180 68.16372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60  1.829467 68.88220</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61  1.764631 69.63098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62  1.728529 70.03697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63  1.661616 71.09823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64  1.627590 71.79147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65  1.592978 72.56549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66  1.562754 74.03274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67  1.543863 75.50000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68  1.533815 76.96726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69  1.526652 78.00100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70        NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71  2.737913 84.36406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72  2.702601 85.77079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73  2.702726 87.23804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74  2.728780 88.70530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75  2.737913 88.92268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76  2.838851 89.49949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77  2.874943 88.70530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78  2.890153 87.23804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79  2.894175 85.77079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80  2.904096 84.30353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81  2.939790 83.29632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82  2.956368 82.83628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83  3.040728 81.45426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84  3.047848 81.36902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85  3.040728 80.91434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86  2.988633 79.90177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87  2.939790 79.77276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88  2.931426 79.90177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89  2.897488 81.36902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90  2.841431 82.83628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91  2.838851 82.84583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92  2.742613 84.30353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93  2.737913 84.36406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94        NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95  3.343544 80.55432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96  3.264362 81.36902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97  3.262814 82.83628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98  3.343544 83.86099</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99  3.444482 84.13361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 3.545420 83.98935</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101 3.564810 84.30353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102 3.646359 85.16856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103 3.667276 85.77079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 104 3.711371 87.23804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 105 3.747297 88.21581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 106 3.761295 88.70530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 107 3.799563 90.17255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 108 3.848236 91.61093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 109 3.850149 91.63981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 110 3.949174 92.85127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111 4.050113 93.07323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112 4.129626 93.10706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 113 4.151051 93.11728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 114 4.251989 93.52810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115 4.352928 93.67499</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 116 4.417983 93.10706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 117 4.453866 92.74089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 118 4.504468 91.63981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 4.554805 90.67480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 120 4.577976 90.17255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121 4.620989 88.70530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 4.655743 87.29638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 123 4.657465 87.23804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 124 4.675729 85.77079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 125 4.679825 84.30353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 126 4.688109 82.83628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 127 4.713564 81.36902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 128 4.756682 80.27291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 129 4.770533 79.90177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 130 4.810875 78.43451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 131 4.847559 76.96726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 132 4.857620 76.04432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 133 4.863988 75.50000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 134 4.857620 74.76464</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 135 4.851404 74.03274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 136 4.826268 72.56549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 137 4.822707 71.09823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 138 4.857620 70.14403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 139 4.879648 69.63098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 140 4.958558 68.64356</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 141 4.993910 68.16372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 142 5.059497 67.26021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 143 5.091469 66.69647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 144 5.131592 65.22921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 145 5.151538 63.76196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 146 5.147964 62.29470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 147 5.130174 60.82745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 148 5.111120 59.36019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 149 5.113432 57.89294</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 150 5.132810 56.42568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 151 5.151330 54.95843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 152 5.160435 53.90290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 153 5.165968 53.49117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 154 5.181295 52.02392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 155 5.186603 50.55666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 156 5.160435 49.79061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 157 5.149455 49.08941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 158 5.106121 47.62215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 159 5.059497 46.71834</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 160 5.031109 46.15490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 161 4.958558 45.21630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 162 4.899437 44.68764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 163 4.857620 44.34279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 164 4.756682 43.99259</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 165 4.655743 43.69261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 166 4.564788 43.22039</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 167 4.554805 43.13902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 168 4.453866 42.53020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169 4.352928 42.38644</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 170 4.251989 42.94142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 171 4.227531 43.22039</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 172 4.151051 43.84742</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 173 4.050113 44.17547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 174 3.960667 44.68764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 175 3.949174 44.74952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 176 3.848236 46.03264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 177 3.841648 46.15490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 178 3.793690 47.62215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 179 3.769244 49.08941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 180 3.750798 50.55666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 181 3.747297 50.87603</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 182 3.724850 52.02392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 183 3.705749 53.49117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 184 3.688124 54.95843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 185 3.677953 56.42568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 186 3.679643 57.89294</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 187 3.695465 59.36019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 188 3.720085 60.82745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 189 3.747297 62.17827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 190 3.749205 62.29470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 191 3.761016 63.76196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 192 3.752194 65.22921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 193 3.747297 65.55238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 194 3.726328 66.69647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 195 3.693492 68.16372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 196 3.646359 69.23910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 197 3.623416 69.63098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 198 3.567201 71.09823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 199 3.545420 71.72056</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 200 3.514052 72.56549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 201 3.499421 74.03274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 202 3.493647 75.50000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 203 3.491131 76.96726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 204 3.476675 78.43451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 205 3.444482 79.45455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 206 3.401653 79.90177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 207 3.343544 80.55432</span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">ci.90</span><span class="op">$</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>    <span class="co"># range for duration</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.440848 5.186603</span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">ci.90</span><span class="op">$</span><span class="va">y</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>    <span class="co"># range for waiting</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 42.38644 99.52422</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">####</span></span></span>
<span class="r-in"><span>   <span class="co">## Visually compare confidence regions </span></span></span>
<span class="r-in"><span>   <span class="co">####</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">geyser</span>, package<span class="op">=</span><span class="st">"MASS"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">## Bivariate smoothed 90 percent confidence region</span></span></span>
<span class="r-in"><span>   <span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">ci2d</span><span class="op">(</span><span class="va">geyser</span><span class="op">$</span><span class="va">duration</span>, <span class="va">geyser</span><span class="op">$</span><span class="va">waiting</span>, show<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">est</span><span class="op">$</span><span class="va">contours</span><span class="op">)</span> <span class="co">## show available contours</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "0.5"   "0.5"   "0.5"   "0.75"  "0.75"  "0.9"   "0.9"   "0.9"   "0.95" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "0.975" "0.975" "0.975" "1"     "1"     "1"     "1"    </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="va">ci.90</span> <span class="op">&lt;-</span> <span class="va">est</span><span class="op">$</span><span class="va">contours</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">est</span><span class="op">$</span><span class="va">contours</span><span class="op">)</span><span class="op">==</span><span class="st">"0.9"</span><span class="op">]</span>  <span class="co"># get region(s)</span></span></span>
<span class="r-in"><span>   <span class="va">ci.90</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ci.90</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="cn">NA</span>, <span class="va">ci.90</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="cn">NA</span>, <span class="va">ci.90</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># join them</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">waiting</span> <span class="op">~</span> <span class="va">duration</span>, data<span class="op">=</span><span class="va">geyser</span>,</span></span>
<span class="r-in"><span>         main<span class="op">=</span><span class="st">"Comparison of 90 percent confidence regions"</span> <span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span> <span class="va">ci.90</span>, col<span class="op">=</span><span class="st">"green"</span>, border<span class="op">=</span><span class="st">"green"</span>, density<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">## Univariate Normal-Theory 90 percent confidence region</span></span></span>
<span class="r-in"><span>   <span class="va">mean.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">geyser</span><span class="op">$</span><span class="va">duration</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">mean.y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">geyser</span><span class="op">$</span><span class="va">waiting</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">sd.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">geyser</span><span class="op">$</span><span class="va">duration</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">sd.y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">geyser</span><span class="op">$</span><span class="va">waiting</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="va">t.value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.95</span><span class="op">)</span>, df<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">geyser</span><span class="op">$</span><span class="va">duration</span><span class="op">)</span>, lower<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">ci.x</span> <span class="op">&lt;-</span> <span class="va">mean.x</span> <span class="op">+</span>  <span class="va">t.value</span><span class="op">*</span> <span class="va">sd.x</span></span></span>
<span class="r-in"><span>   <span class="va">ci.y</span> <span class="op">&lt;-</span> <span class="va">mean.y</span> <span class="op">+</span>  <span class="va">t.value</span><span class="op">*</span> <span class="va">sd.y</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="plotCI.html">plotCI</a></span><span class="op">(</span><span class="va">mean.x</span>, <span class="va">mean.y</span>,</span></span>
<span class="r-in"><span>          li<span class="op">=</span><span class="va">ci.x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>          ui<span class="op">=</span><span class="va">ci.x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>          barcol<span class="op">=</span><span class="st">"blue"</span>, col<span class="op">=</span><span class="st">"blue"</span>,</span></span>
<span class="r-in"><span>          err<span class="op">=</span><span class="st">"x"</span>,</span></span>
<span class="r-in"><span>          pch<span class="op">=</span><span class="st">"X"</span>,</span></span>
<span class="r-in"><span>          add<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="plotCI.html">plotCI</a></span><span class="op">(</span><span class="va">mean.x</span>, <span class="va">mean.y</span>,</span></span>
<span class="r-in"><span>          li<span class="op">=</span><span class="va">ci.y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>          ui<span class="op">=</span><span class="va">ci.y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>          barcol<span class="op">=</span><span class="st">"blue"</span>, col<span class="op">=</span><span class="st">"blue"</span>,</span></span>
<span class="r-in"><span>          err<span class="op">=</span><span class="st">"y"</span>,</span></span>
<span class="r-in"><span>          pch<span class="op">=</span><span class="cn">NA</span>,</span></span>
<span class="r-in"><span>          add<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#   rect(ci.x[1], ci.y[1], ci.x[2], ci.y[2], border="blue",</span></span></span>
<span class="r-in"><span><span class="co">#        density=5,</span></span></span>
<span class="r-in"><span><span class="co">#        angle=45,</span></span></span>
<span class="r-in"><span><span class="co">#        col="blue" )</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">## Empirical univariate 90 percent confidence region</span></span></span>
<span class="r-in"><span>   <span class="va">box</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span> <span class="va">geyser</span><span class="op">$</span><span class="va">duration</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span> <span class="op">)</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                 y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span> <span class="va">geyser</span><span class="op">$</span><span class="va">waiting</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span> <span class="op">)</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/rect.html" class="external-link">rect</a></span><span class="op">(</span><span class="va">box</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">box</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">box</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">box</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span>, border<span class="op">=</span><span class="st">"red"</span>,</span></span>
<span class="r-in"><span>        density<span class="op">=</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span>        angle<span class="op">=</span><span class="op">-</span><span class="fl">45</span>,</span></span>
<span class="r-in"><span>        col<span class="op">=</span><span class="st">"red"</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">## now a nice legend</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span> <span class="st">"topright"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"       Region type"</span>,</span></span>
<span class="r-in"><span>                                <span class="st">"Univariate Normal Theory"</span>,</span></span>
<span class="r-in"><span>                                <span class="st">"Univarite Empirical"</span>,</span></span>
<span class="r-in"><span>                                <span class="st">"Smoothed Bivariate"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"blue"</span>,<span class="st">"red"</span>,<span class="st">"green"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>         <span class="op">)</span></span></span>
<span class="r-plt img"><img src="ci2d-19.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">####</span></span></span>
<span class="r-in"><span>   <span class="co">## Test with a large number of points</span></span></span>
<span class="r-in"><span>   <span class="co">####</span></span></span>
<span class="r-in"><span>   <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>   <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">60000</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">40000</span>, mean<span class="op">=</span><span class="va">x</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20000</span>, mean<span class="op">=</span><span class="va">x</span><span class="op">+</span><span class="fl">4</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="hist2d.html">hist2d</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu">ci2d</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">ci</span></span></span>
<span class="r-in"><span>   <span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Gregory R. Warnes, Ben Bolker, Lodewijk Bonebakker, Robert Gentleman, Wolfgang Huber, Andy Liaw, Thomas Lumley, Martin Maechler, Arni Magnusson, Steffen Moeller, Marc Schwartz, Bill Venables, Tal Galili.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

