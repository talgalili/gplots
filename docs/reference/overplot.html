<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot multiple variables on the same region, with appropriate axes — overplot • gplots</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plot multiple variables on the same region, with appropriate axes — overplot"><meta property="og:description" content="overplot graphs a set of variables defined on the same x-range
  but which have varying y-ranges on the same plotting area.  For each
  set of y-values it uses a different color and line-type and and draws
  a correspondingly colored and line-typed axis.  panel.overplot
  is used by overplot to draw the individual graphs."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gplots</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/heatmap.2.html">Enhanced Heat Maps with heatmap.2</a>
    </li>
    <li>
      <a href="../articles/venn.html">Venn Diagrams with `gplots`</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/talgalili/gplots/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot multiple variables on the same region, with appropriate axes</h1>

    <div class="hidden name"><code>overplot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>overplot</code> graphs a set of variables defined on the same x-range
  but which have varying y-ranges on the same plotting area.  For each
  set of y-values it uses a different color and line-type and and draws
  a correspondingly colored and line-typed axis.  <code>panel.overplot</code>
  is used by <code>overplot</code> to draw the individual graphs.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">overplot</span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span>, same.scale <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">xlab</span>, <span class="va">ylab</span>,</span>
<span>         <span class="va">xlim</span>, <span class="va">ylim</span>, <span class="va">min.y</span>, <span class="va">max.y</span>, log <span class="op">=</span> <span class="st">""</span>, panel <span class="op">=</span> <span class="st">"panel.overplot"</span>,</span>
<span>         <span class="va">subset</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">groups</span>, <span class="va">main</span>, f <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>Formula describing the x and y variables.  It should be
    of the form x ~ y|z. The conditioning variable (z) should be a factor.</p></dd>

  <dt id="arg-same-scale">same.scale<a class="anchor" aria-label="anchor" href="#arg-same-scale"></a></dt>
<dd><p>Logical value indicating whether the plot region
    should have the same range for all plots.  Defaults to <code>FALSE</code>.</p></dd>

  <dt id="arg-xlab-ylab-xlim-ylim-main">xlab, ylab, xlim, ylim, main<a class="anchor" aria-label="anchor" href="#arg-xlab-ylab-xlim-ylim-main"></a></dt>
<dd><p>Standard plotting parameters.  See
    <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code> for details</p></dd>

  <dt id="arg-min-y-max-y">min.y, max.y<a class="anchor" aria-label="anchor" href="#arg-min-y-max-y"></a></dt>
<dd><p>Scalar or vector values used to specify the y
    plotting limits for individual plots.  If a single scalar value is
    provided, it will be used for all plots. These parameters can be
    used specify one end of the individual plot ranges, while allowing
    the other end to vary with the data.  EG, to force 0 to always be
    within the plot region.</p></dd>

  <dt id="arg-log">log<a class="anchor" aria-label="anchor" href="#arg-log"></a></dt>
<dd><p>character string ”, 'x', 'y', or 'xy', indicating which axes
    should be plotted on a log scale. Defaults to ” (neither).</p></dd>

  <dt id="arg-panel">panel<a class="anchor" aria-label="anchor" href="#arg-panel"></a></dt>
<dd><p>a plotting function to be called to draw the individual
    plots.  Defaults to <code>overplot.panel</code>, which plots the points
    and a <code>lowess</code> smooth.</p></dd>

  <dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Logical value indicating whether to draw the plot.</p></dd>

  <dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>(optional) character vector giving the names of levels
    of the conditioning variable to plot. Defaults to all levels of the
    conditioning variable.</p></dd>

  <dt id="arg-f">f<a class="anchor" aria-label="anchor" href="#arg-f"></a></dt>
<dd><p>Smoothing parameter for <code>lowess</code></p></dd>

  <dt id="arg-data-subset-">data, subset, ...<a class="anchor" aria-label="anchor" href="#arg-data-subset-"></a></dt>
<dd><p>parameters passed to <code>model.frame</code> to
    obtain the data to be plotted from the formula.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function essentially performs</p>
<p>tmp &lt;- split(data, z)</p>
<p>for(i in levels(z))</p>
<p>plot( x ~ y, data=tmp[[z]] )</p>
<p>except that all of the plots are shown on the same plotting region and
  varying scales for each value of z are handled nicely.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A copy of the data split by the conditioning variable.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Gregory R. Warnes <a href="mailto:greg@warnes.net">greg@warnes.net</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/interaction.plot.html" class="external-link">interaction.plot</a></code>,
  <code><a href="https://rdrr.io/r/graphics/coplot.html" class="external-link">coplot</a></code> for alternative visualizations of 3-way data.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example teratogenicity rtPCR data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rtPCR</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># same scale</span></span></span>
<span class="r-in"><span><span class="fu">overplot</span><span class="op">(</span> <span class="va">RQ</span> <span class="op">~</span> <span class="va">Conc..ug.ml.</span> <span class="op">|</span> <span class="va">Test.Substance</span>,</span></span>
<span class="r-in"><span>         data<span class="op">=</span><span class="va">rtPCR</span>,</span></span>
<span class="r-in"><span>         subset<span class="op">=</span><span class="va">Detector</span><span class="op">==</span><span class="st">"ProbeType 1"</span> <span class="op">&amp;</span> <span class="va">Conc..ug.ml.</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>         same.scale<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>         log<span class="op">=</span><span class="st">"xy"</span>,</span></span>
<span class="r-in"><span>         f<span class="op">=</span><span class="fl">3</span><span class="op">/</span><span class="fl">4</span>,</span></span>
<span class="r-in"><span>         main<span class="op">=</span><span class="st">"Detector=ProbeType 1"</span>,</span></span>
<span class="r-in"><span>         xlab<span class="op">=</span><span class="st">"Concentration (ug/ml)"</span>,</span></span>
<span class="r-in"><span>         ylab<span class="op">=</span><span class="st">"Relative Gene Quantification"</span></span></span>
<span class="r-in"><span>         <span class="op">)</span></span></span>
<span class="r-plt img"><img src="overplot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># different scales, but force lower limit to 0.01 </span></span></span>
<span class="r-in"><span><span class="fu">overplot</span><span class="op">(</span> <span class="va">RQ</span> <span class="op">~</span> <span class="va">Conc..ug.ml.</span> <span class="op">|</span> <span class="va">Test.Substance</span>,</span></span>
<span class="r-in"><span>         data<span class="op">=</span><span class="va">rtPCR</span>,</span></span>
<span class="r-in"><span>         subset<span class="op">=</span><span class="va">Detector</span><span class="op">==</span><span class="st">"ProbeType 8"</span> <span class="op">&amp;</span> <span class="va">Conc..ug.ml.</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>         log<span class="op">=</span><span class="st">"xy"</span>,</span></span>
<span class="r-in"><span>         f<span class="op">=</span><span class="fl">3</span><span class="op">/</span><span class="fl">4</span>,</span></span>
<span class="r-in"><span>         main<span class="op">=</span><span class="st">"Detector=ProbeType 8"</span>,</span></span>
<span class="r-in"><span>         xlab<span class="op">=</span><span class="st">"Concentration (ug/ml)"</span>,</span></span>
<span class="r-in"><span>         ylab<span class="op">=</span><span class="st">"Relative Gene Quantification"</span>,</span></span>
<span class="r-in"><span>         min.y<span class="op">=</span><span class="fl">0.01</span></span></span>
<span class="r-in"><span>         <span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 y value &lt;= 0 omitted from logarithmic plot</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 y value &lt;= 0 omitted from logarithmic plot</span>
<span class="r-plt img"><img src="overplot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Gregory R. Warnes, Ben Bolker, Lodewijk Bonebakker, Robert Gentleman, Wolfgang Huber, Andy Liaw, Thomas Lumley, Martin Maechler, Arni Magnusson, Steffen Moeller, Marc Schwartz, Bill Venables, Tal Galili.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

